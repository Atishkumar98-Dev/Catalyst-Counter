<!-- upload_data.html -->
<form id="uploadForm" enctype="multipart/form-data">
    <input type="file" name="file" required>
    <button type="submit">Upload CSV</button>
</form>
<div id="progressContainer" style="display:none;">
    <progress id="uploadProgress" value="0" max="100"></progress>
    <span id="uploadStatus"></span>
</div>

<script>
    $('#uploadForm').on('submit', function(event) {
        event.preventDefault();
        var formData = new FormData(this);

        $('#progressContainer').show();
        var xhr = new XMLHttpRequest();
        xhr.open('POST', '{% url "upload_csv" %}', true);

        xhr.upload.onprogress = function(event) {
            if (event.lengthComputable) {
                var percentComplete = (event.loaded / event.total) * 100;
                $('#uploadProgress').val(percentComplete);
                $('#uploadStatus').text(Math.round(percentComplete) + '% uploaded');
            }
        };

        xhr.onload = function() {
            if (xhr.status === 200) {
                alert('File uploaded successfully!');
            } else {
                alert('Error uploading file.');
            }
        };

        xhr.send(formData);
    });
</script>
